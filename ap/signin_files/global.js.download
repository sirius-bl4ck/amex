//Manage1 Rule ID is : 6454
//Overriding as part of MYCA acount summary observation to append to body - 06/30/2015
//Overriding as part of oneAmex  - 05/21/2018
//Added Norway to EU cookie array #ITM-124
//Req #ITM-395 - Removed digitalData.view.country occurences and replaced it with locale.
//ITM-452 - Added poland market locales to EU Array

//Handler Logic
if(typeof document.documentElement!=="undefined"&&typeof document.documentElement.lang!=="undefined"&&document.documentElement.lang!==""&&document.documentElement.lang!==null){Bootstrapper.locale=document.documentElement.lang.split("-")[1]}Bootstrapper.pathname=window.location.pathname;window.ruleLoaded=true;var appArr=[Bootstrapper.ensApp];if(typeof(window.digitalDataHandlers)!="undefined"){window.digitalDataHandlers.push(ensightenHandler)}function ensightenHandler(digitalData){if(digitalData.diff.includes("view")||digitalData.diff.includes("events")||digitalData.diff.includes("products")||digitalData.diff.includes("campaigns")){if(digitalData.diff.includes("view")){var ensapp=Bootstrapper.ensApp}var locale=digitalData.view.locale;var view=digitalData.view.viewId;var country=digitalData.view.locale.split("-")[1];Bootstrapper.ensMarket=locale;Bootstrapper.digitalData=digitalData;Bootstrapper.ensApp="myca";if(window.location.pathname.indexOf("/business/merchant/")>-1||window.location.pathname.indexOf("/affaires/marchands/")>-1||window.location.pathname.indexOf("/mercante/prospettive/")>-1||window.location.pathname.indexOf("/aussichten/kartenakzeptanz/")>-1||window.location.pathname.indexOf("/comerciante/prospectos/aceptar-tarjeta/")>-1||window.location.pathname.indexOf("/zakelijk/handelaar/vooruitzicht/aanvaarden-kaart/")>-1){Bootstrapper.ensApp="mer"}else{if(window.location.hostname.indexOf("acquisition")>-1||window.location.href.indexOf("/credit-cards")>-1||window.location.pathname.indexOf("/referral")>-1||window.location.pathname.indexOf("/apply")>-1||window.location.pathname.indexOf("-credit-cards")>-1){Bootstrapper.ensApp="acq"}else{if(window.location.pathname.indexOf("/rewards")>-1||decodeURIComponent(window.location.search).indexOf("/rewards")>-1){Bootstrapper.ensApp="rewards"}else{if(window.location.pathname.indexOf("entertainment")>-1){Bootstrapper.ensApp="ehub"}else{if(window.location.pathname.indexOf("/trends-and-insights")>-1){Bootstrapper.ensApp="openforum"}else{if(window.location.hostname.indexOf("travel")>-1||window.location.pathname.indexOf("en-gb/travel")>-1||window.location.pathname.indexOf("en-us/travel")>-1||window.location.pathname.indexOf("en-au/travel")>-1||window.location.pathname.indexOf("en-nz/travel")>-1||window.location.pathname.indexOf("/account/travel/")>-1||window.location.pathname.indexOf("/en-ca/travel/")>-1||window.location.pathname.indexOf("/fr-ca/travel/")>-1){Bootstrapper.ensApp="travel"}}}}}}if(typeof(digitalData.events)!=="undefined"&&typeof(digitalData.events[0])!=="undefined"&&typeof(digitalData.events[0].type)!=="undefined"){if(typeof(digitalData.events[0].element)!=="undefined"){Bootstrapper.pageName=digitalData.events[0].element}if(typeof(digitalData.events[0].meta)!=="undefined"){if(typeof(digitalData.events[0].meta.appdecision)!=="undefined"){Bootstrapper.appDecision=digitalData.events[0].meta.appdecision}else{if(typeof(digitalData.events[0].meta.appDecision)!=="undefined"){Bootstrapper.appDecision=digitalData.events[0].meta.appDecision}}if(typeof(digitalData.events[0].meta.applicationType)!=="undefined"){Bootstrapper.applicationType=digitalData.events[0].meta.applicationType}if(typeof(digitalData.events[0].meta.pcn)!=="undefined"){Bootstrapper.pcn=digitalData.events[0].meta.pcn}if(typeof(digitalData.events[0].meta.products)!=="undefined"&&typeof(digitalData.events[0].meta.products[0])!=="undefined"){Bootstrapper.productName=digitalData.events[0].meta.products[0].description;Bootstrapper.pmc=digitalData.events[0].meta.products[0].id}}}if(Bootstrapper.locale!==country){Bootstrapper.euCheck=true;Bootstrapper.EUCookievar.userLocale=locale;Bootstrapper.ensMarket=digitalData.view.locale;Bootstrapper.locale=digitalData.view.locale.split("-")[1];checkUserConsent();var u=window.location.href;var extraparams="?ens_env=3&ensMarket="+digitalData.view.locale+"&ensApp="+Bootstrapper.ensApp+"&deviceType="+Bootstrapper.deviceType;u=u+extraparams;if(window.location.hostname.indexOf(".aexp.com")<0){Bootstrapper.loadScriptCallback("https://"+o.nexus+"/"+o.client+"/"+o.publishPath+"/serverComponent.php?clientID="+o.clientId+"&PageID="+encodeURIComponent(u),function(){})}}else{if(Bootstrapper.ensMarket===locale&&Bootstrapper.pathname===digitalData.view.viewId){Bootstrapper.viewId=digitalData.view.viewId;Bootstrapper.country=digitalData.view.locale.split("-")[1];Bootstrapper.ensEvent.trigger(Bootstrapper.ensMarket.split("-")[1]+"-SPA-AllPages",Bootstrapper.ensMarket,Bootstrapper.locale,Bootstrapper.viewId);if(digitalData.diff.includes("events")&&(Bootstrapper.ensApp==="acq"||Bootstrapper.ensApp==="mer")&&digitalData.events[0]!=="undefined"&&typeof(digitalData.events[0].type)!=="undefined"){Bootstrapper.digitalData=digitalData;if(Bootstrapper.euCheck){Bootstrapper.ensEvent.trigger(Bootstrapper.ensApp+"-"+Bootstrapper.ensMarket.split("-")[1]+"-SPA-AllPages",Bootstrapper.ensMarket,Bootstrapper.locale,Bootstrapper.viewId,Bootstrapper.digitalData)}else{Bootstrapper.ensEvent.trigger(Bootstrapper.ensApp+"-"+Bootstrapper.ensMarket.split("-")[1]+"-SPA-AllPages",Bootstrapper.ensMarket,Bootstrapper.locale,Bootstrapper.viewId,Bootstrapper.digitalData);Bootstrapper.ensEvent.trigger(Bootstrapper.ensApp+"-"+Bootstrapper.ensMarket.split("-")[1]+"-"+Bootstrapper.applicationType+"-"+Bootstrapper.pmc+"-MarketingTags-SPA-AllPages",Bootstrapper.ensMarket,Bootstrapper.locale,Bootstrapper.viewId,Bootstrapper.pmc,Bootstrapper.pageName,Bootstrapper.digitalData);Bootstrapper.ensEvent.trigger(Bootstrapper.ensApp+"-"+Bootstrapper.ensMarket.split("-")[1]+"-Referral-MarketingTags-SPA-AllPages",Bootstrapper.ensMarket,Bootstrapper.locale,Bootstrapper.viewId,Bootstrapper.digitalData);Bootstrapper.ensEvent.trigger(Bootstrapper.ensApp+"-"+Bootstrapper.ensMarket.split("-")[1]+"-Supps-MarketingTags-SPA-AllPages",Bootstrapper.ensMarket,Bootstrapper.locale,Bootstrapper.viewId,Bootstrapper.pmc,Bootstrapper.pageName,Bootstrapper.digitalData);Bootstrapper.ensEvent.trigger(Bootstrapper.ensApp+"-"+Bootstrapper.ensMarket.split("-")[1]+"-personal-loan-MarketingTags-SPA-AllPages",Bootstrapper.ensMarket,Bootstrapper.locale,Bootstrapper.viewId,Bootstrapper.pageName,Bootstrapper.digitalData);Bootstrapper.ensEvent.trigger(Bootstrapper.ensApp+"-"+Bootstrapper.ensMarket.split("-")[1]+"-MarketingTags-SPA-AllPages",Bootstrapper.ensMarket,Bootstrapper.locale,Bootstrapper.viewId,Bootstrapper.pageName,Bootstrapper.digitalData);Bootstrapper.ensEvent.trigger(Bootstrapper.ensApp+"-"+Bootstrapper.ensMarket.split("-")[1]+"-corpxselloffers-MarketingTags-SPA-AllPages",Bootstrapper.ensMarket,Bootstrapper.locale,Bootstrapper.viewId,Bootstrapper.pageName,Bootstrapper.digitalData)}}else{if(digitalData.diff.includes("products")&&Bootstrapper.ensApp==="travel"){Bootstrapper.digitalData=digitalData;if(Bootstrapper.euCheck){Bootstrapper.ensEvent.trigger(Bootstrapper.ensApp+"-"+Bootstrapper.ensMarket.split("-")[1]+"-SPA-AllPages",Bootstrapper.ensMarket,Bootstrapper.locale,Bootstrapper.viewId)}else{Bootstrapper.ensEvent.trigger(Bootstrapper.ensApp+"-"+Bootstrapper.ensMarket.split("-")[1]+"-SPA-AllPages",Bootstrapper.ensMarket,Bootstrapper.locale,Bootstrapper.viewId);Bootstrapper.ensEvent.trigger(Bootstrapper.ensApp+"-"+Bootstrapper.ensMarket.split("-")[1]+"-MarketingTags-SPA-AllPages",Bootstrapper.ensMarket,Bootstrapper.locale,Bootstrapper.viewId)}}else{if((Bootstrapper.ensMarket==="en-US"&&Bootstrapper.ensApp==="myca"&&Bootstrapper.pathname===digitalData.view.viewId&&typeof digitalData!=="undefined"&&typeof digitalData.events==="object"&&typeof(digitalData.events[0])!="undefined"&&typeof digitalData.events[0].identifier!=="undefined"&&digitalData.events[0].identifier==="axp-offers")||(Bootstrapper.ensMarket==="en-US"&&Bootstrapper.ensApp==="rewards"&&Bootstrapper.pathname===digitalData.view.viewId&&typeof digitalData!=="undefined"&&typeof digitalData.events==="object"&&typeof(digitalData.events[0])!="undefined"&&typeof digitalData.events[0].identifier!=="undefined"&&(digitalData.events[0].identifier.indexOf("axp-global-rewards-")>-1||digitalData.events[0].identifier.indexOf("axp-mr-your-charges")>-1||digitalData.events[0].identifier.indexOf("axp-mr-common")>-1))||(Bootstrapper.pathname.indexOf("/en-us/account/shop-small/login")>-1&&Bootstrapper.pageName.toLowerCase()==="login")){Bootstrapper.digitalData=digitalData;Bootstrapper.offerType=Bootstrapper.digitalData.events[0].element;Bootstrapper.detail=Bootstrapper.digitalData.events[0].detail;Bootstrapper.ensEvent.trigger(Bootstrapper.ensApp+"-"+Bootstrapper.ensMarket.split("-")[1]+"-MarketingTags-SPA-AllPages",Bootstrapper.ensMarket,Bootstrapper.locale,Bootstrapper.viewId,Bootstrapper.offerType,Bootstrapper.detail,Bootstrapper.digitalData)}else{if(Bootstrapper.ensApp==="openforum"&&digitalData.diff.includes("events")&&digitalData.events[0]!=="undefined"&&typeof(digitalData.events[0].type)!=="undefined"&&digitalData.events[0].type==="click"&&Bootstrapper.pathname===digitalData.view.viewId){Bootstrapper.digitalData=digitalData;Bootstrapper.ensEvent.trigger(Bootstrapper.ensApp+"-"+Bootstrapper.ensMarket.split("-")[1]+"-SPA-AllPages",Bootstrapper.ensMarket,Bootstrapper.locale,Bootstrapper.viewId);Bootstrapper.ensEvent.trigger(Bootstrapper.ensApp+"-"+Bootstrapper.ensMarket.split("-")[1]+"-MarketingTags-SPA-AllPages",Bootstrapper.ensMarket,Bootstrapper.locale,Bootstrapper.viewId,Bootstrapper.digitalData)}else{if(Bootstrapper.ensMarket===locale&&Bootstrapper.pathname===digitalData.view.viewId&&ruleLoaded===true){}}}}}}else{if(Bootstrapper.ensMarket===locale&&Bootstrapper.pathname!==digitalData.view.viewId){Bootstrapper.viewId=digitalData.view.viewId;if(appArr.indexOf(Bootstrapper.ensApp)===-1){var u=window.location.href;var extraparams="?ens_env=3&ensMarket="+digitalData.view.locale+"&ensApp="+Bootstrapper.ensApp+"&deviceType="+Bootstrapper.deviceType;u=u+extraparams;if(window.location.hostname.indexOf(".aexp.com")<0){Bootstrapper.loadScriptCallback("https://"+o.nexus+"/"+o.client+"/"+o.publishPath+"/serverComponent.php?clientID="+o.clientId+"&PageID="+encodeURIComponent(u),function(){appArr.push(Bootstrapper.ensApp)})}}else{Bootstrapper.pathname=digitalData.view.viewId;Bootstrapper.digitalData=digitalData;Bootstrapper.ensMarket=digitalData.view.locale;Bootstrapper.country=digitalData.view.locale.split("-")[1];Bootstrapper.viewId=digitalData.view.viewId;if(Bootstrapper.euCheck){Bootstrapper.ensEvent.trigger(Bootstrapper.ensApp+"-"+Bootstrapper.ensMarket.split("-")[1]+"-SPA-AllPages",Bootstrapper.ensMarket,Bootstrapper.country,Bootstrapper.viewId,Bootstrapper.digitalData)}else{Bootstrapper.ensEvent.trigger(Bootstrapper.ensApp+"-"+Bootstrapper.ensMarket.split("-")[1]+"-SPA-AllPages",Bootstrapper.ensMarket,Bootstrapper.country,Bootstrapper.viewId,Bootstrapper.digitalData);Bootstrapper.ensEvent.trigger(Bootstrapper.ensApp+"-"+Bootstrapper.ensMarket.split("-")[1]+"-MarketingTags-SPA-AllPages",Bootstrapper.ensMarket,Bootstrapper.country,Bootstrapper.viewId,Bootstrapper.digitalData)}}ruleLoaded=false}}}}};