window.chatRulesUI=window.chatRulesUI||{},chatRulesUI.ChatRules=chatRulesUI.ChatRules||function(){var a=this;// changes every 16 minutes.
getCacheValue=function(){var a=Date.now().toString();return a.substring(0,7)},initialize=function(){try{if(Bootstrapper.readCookie('amexsessioncookie')&&-1===location.href.indexOf('americanexpress.com/login')){var a=Bootstrapper.readCookie('chatDomains');if(('undefined'==typeof a||null===a)&&(a=''),-1===a.indexOf(location.hostname)){var b=a+','+location.hostname;clearSessionData(b)}if(null===document.getElementById('chatRules')){var c=getCacheValue(),d=getChatRulesMap()+'?'+c;ajax_get(d,function(a){loadChatScripts('chatRules',a.clicktochat.attributes.src,a.clicktochat.attributes.integrity)})}}else clearSessionData(location.hostname)}catch(a){}},ajax_get=function(a,b){var c=new XMLHttpRequest;c.onreadystatechange=function(){if(4==c.readyState&&200==c.status){try{var a=JSON.parse(c.responseText)}catch(a){return}b(a)}},c.open('GET',a,!0),c.send()},loadChatScripts=function(a,b,c){try{var d=document.createElement('script');d.type='application/javascript',d.id=a,d.src=b,d.integrity=c,d.crossOrigin='anonymous',document.body.appendChild(d)}catch(a){}},getChatRulesMap=function(){var a='https://icm.aexp-static.com/content/dam/chat/prod/us/js/chatRulesMap.json';try{switch(Bootstrapper.ensEnv){case'1':a='https://origin-pqgemapp.americanexpress.com/content/dam/chat/dev/js/chatRulesMap.json';break;case'2':a='https://origin-pqgemapp.americanexpress.com/content/dam/chat/qa/us/js/chatRulesMap.json';break;case'3':a=-1===location.hostname.indexOf('slglobal.americanexpress.com')?'https://icm.aexp-static.com/content/dam/chat/prod/us/js/chatRulesMap.json':'https://icm.aexp-static.com/content/dam/chat/sl/us/js/chatRulesMap.json';}}catch(a){}return a},clearSessionData=function(a){document.cookie='chatDomains='+a+';domain=.americanexpress.com;path=/',sessionStorage.removeItem('chatDataSource')},a.initialize=function(){initialize()}},chatRules=new chatRulesUI.ChatRules(window),chatRules.initialize();